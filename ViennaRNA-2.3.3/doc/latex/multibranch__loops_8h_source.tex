\hypertarget{multibranch__loops_8h_source}{}\section{multibranch\+\_\+loops.\+h}
\label{multibranch__loops_8h_source}\index{Vienna\+R\+N\+A/multibranch\+\_\+loops.\+h@{Vienna\+R\+N\+A/multibranch\+\_\+loops.\+h}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#ifndef VIENNA\_RNA\_PACKAGE\_MULTIBRANCH\_LOOPS\_H}
00002 \textcolor{preprocessor}{#define VIENNA\_RNA\_PACKAGE\_MULTIBRANCH\_LOOPS\_H}
00003 
00004 \textcolor{preprocessor}{#include <\hyperlink{utils_8h}{ViennaRNA/utils.h}>}
00005 \textcolor{preprocessor}{#include <\hyperlink{data__structures_8h}{ViennaRNA/data\_structures.h}>}
00006 \textcolor{preprocessor}{#include <\hyperlink{params_8h}{ViennaRNA/params.h}>}
00007 
00008 \textcolor{preprocessor}{#ifdef \_\_GNUC\_\_}
00009 \textcolor{preprocessor}{# define INLINE inline}
00010 \textcolor{preprocessor}{#else}
00011 \textcolor{preprocessor}{# define INLINE}
00012 \textcolor{preprocessor}{#endif}
00013 
\hypertarget{multibranch__loops_8h_source.tex_l00032}{}\hyperlink{group__loops}{00032} \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{
00033   \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}  *qqm;
00034   \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}  *qqm1;
00035 
00036   \textcolor{keywordtype}{int}         qqmu\_size;
00037   \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}  **qqmu;
00038 \} \hyperlink{group__loops_structvrna__mx__pf__aux__ml__t}{vrna\_mx\_pf\_aux\_ml\_t};
00039 
00040 
00060 PRIVATE INLINE \textcolor{keywordtype}{int} E\_MLstem( \textcolor{keywordtype}{int} type,
00061                               \textcolor{keywordtype}{int} si1,
00062                               \textcolor{keywordtype}{int} sj1,
00063                               \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P);
00064 
00071 PRIVATE INLINE \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL} exp\_E\_MLstem(\textcolor{keywordtype}{int} type,
00072                                     \textcolor{keywordtype}{int} si1,
00073                                     \textcolor{keywordtype}{int} sj1,
00074                                     \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t} *P);
00075 
00076 
00077 
00083 \textcolor{keywordtype}{int} \hyperlink{multibranch__loops_8h_a81d73d23f480f84df8cfd0042c032503}{E\_mb\_loop\_stack}(\textcolor{keywordtype}{int} i, \textcolor{keywordtype}{int} j, \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc);
00084 
00100 \textcolor{keywordtype}{int}
00101 \hyperlink{multibranch__loops_8h_a9cb520ddfd8b3a48089a7910b045d06b}{vrna\_BT\_mb\_loop}(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00102                 \textcolor{keywordtype}{int} *i,
00103                 \textcolor{keywordtype}{int} *j,
00104                 \textcolor{keywordtype}{int} *k,
00105                 \textcolor{keywordtype}{int} en,
00106                 \textcolor{keywordtype}{int} *component1,
00107                 \textcolor{keywordtype}{int} *component2);
00108 
00109 \textcolor{keywordtype}{int}
00110 vrna\_E\_mb\_loop\_fast(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00111                     \textcolor{keywordtype}{int} i,
00112                     \textcolor{keywordtype}{int} j,
00113                     \textcolor{keywordtype}{int} *dmli1,
00114                     \textcolor{keywordtype}{int} *dmli2);
00115 
00116 \textcolor{keywordtype}{int}
00117 \hyperlink{multibranch__loops_8h_a81d73d23f480f84df8cfd0042c032503}{E\_mb\_loop\_stack}(\textcolor{keywordtype}{int} i,
00118                 \textcolor{keywordtype}{int} j,
00119                 \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc);
00120 
00121 \textcolor{keywordtype}{int}
00122 E\_ml\_rightmost\_stem(\textcolor{keywordtype}{int} i,
00123                     \textcolor{keywordtype}{int} j,
00124                     \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc);
00125 
00126 \textcolor{keywordtype}{int}
00127 vrna\_E\_ml\_stems\_fast( \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00128                       \textcolor{keywordtype}{int} i,
00129                       \textcolor{keywordtype}{int} j,
00130                       \textcolor{keywordtype}{int} *fmi,
00131                       \textcolor{keywordtype}{int} *dmli);
00132 
00133 
00134 \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}
00135 vrna\_exp\_E\_mb\_loop\_fast( \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00136                     \textcolor{keywordtype}{int} i,
00137                     \textcolor{keywordtype}{int} j,
00138                     \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL} *qqm1);
00139 
00140 
00141 \hyperlink{group__loops_structvrna__mx__pf__aux__ml__t}{vrna\_mx\_pf\_aux\_ml\_t} *
00142 vrna\_exp\_E\_ml\_fast\_init(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc);
00143 
00144 
00145 \textcolor{keywordtype}{void}
00146 vrna\_exp\_E\_ml\_fast\_rotate(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc,
00147                           \hyperlink{group__loops_structvrna__mx__pf__aux__ml__t}{vrna\_mx\_pf\_aux\_ml\_t}   *aux\_mx);
00148 
00149 
00150 \textcolor{keywordtype}{void}
00151 vrna\_exp\_E\_ml\_fast\_free(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t}  *vc,
00152                           \hyperlink{group__loops_structvrna__mx__pf__aux__ml__t}{vrna\_mx\_pf\_aux\_ml\_t} *aux\_mx);
00153 
00154 
00155 \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}
00156 vrna\_exp\_E\_ml\_fast(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00157                    \textcolor{keywordtype}{int}                  i,
00158                    \textcolor{keywordtype}{int}                  j,
00159                    \hyperlink{group__loops_structvrna__mx__pf__aux__ml__t}{vrna\_mx\_pf\_aux\_ml\_t}  *aux\_mx);
00160 
00161 \textcolor{comment}{/*}
00162 \textcolor{comment}{#################################}
00163 \textcolor{comment}{# Backtracking functions below  #}
00164 \textcolor{comment}{#################################}
00165 \textcolor{comment}{*/}
00166 
00167 \textcolor{keywordtype}{int}
00168 vrna\_BT\_mb\_loop\_fake( \hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00169                       \textcolor{keywordtype}{int} *u,
00170                       \textcolor{keywordtype}{int} *i,
00171                       \textcolor{keywordtype}{int} *j,
00172                       \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t} *bp\_stack,
00173                       \textcolor{keywordtype}{int} *stack\_count);
00174 
00175 \textcolor{keywordtype}{int}
00176 vrna\_BT\_mb\_loop\_split(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00177                       \textcolor{keywordtype}{int} *i,
00178                       \textcolor{keywordtype}{int} *j,
00179                       \textcolor{keywordtype}{int} *k,
00180                       \textcolor{keywordtype}{int} *l,
00181                       \textcolor{keywordtype}{int} *component1,
00182                       \textcolor{keywordtype}{int} *component2,
00183                       \hyperlink{group__data__structures_structvrna__bp__stack__s}{vrna\_bp\_stack\_t} *bp\_stack,
00184                       \textcolor{keywordtype}{int} *stack\_count);
00185 
00186 \textcolor{keywordtype}{int}
00187 \hyperlink{multibranch__loops_8h_a9cb520ddfd8b3a48089a7910b045d06b}{vrna\_BT\_mb\_loop}(\hyperlink{group__fold__compound_structvrna__fc__s}{vrna\_fold\_compound\_t} *vc,
00188                 \textcolor{keywordtype}{int} *i,
00189                 \textcolor{keywordtype}{int} *j,
00190                 \textcolor{keywordtype}{int} *k,
00191                 \textcolor{keywordtype}{int} en,
00192                 \textcolor{keywordtype}{int} *component1,
00193                 \textcolor{keywordtype}{int} *component2);
00194 
00195 \textcolor{comment}{/*}
00196 \textcolor{comment}{########################################}
00197 \textcolor{comment}{# BEGIN OF INLINE FUNCTION DEFINITIONS #}
00198 \textcolor{comment}{########################################}
00199 \textcolor{comment}{*/}
00200 
00201 
00202 PRIVATE INLINE \textcolor{keywordtype}{int} E\_MLstem(\textcolor{keywordtype}{int} type, \textcolor{keywordtype}{int} si1, \textcolor{keywordtype}{int} sj1, \hyperlink{group__energy__parameters_structvrna__param__s}{vrna\_param\_t} *P)\{
00203   \textcolor{keywordtype}{int} energy = 0;
00204   \textcolor{keywordflow}{if}(si1 >= 0 && sj1 >= 0)\{
00205     energy += P->mismatchM[type][si1][sj1];
00206   \}
00207   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (si1 >= 0)\{
00208     energy += P->dangle5[type][si1];
00209   \}
00210   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sj1 >= 0)\{
00211     energy += P->dangle3[type][sj1];
00212   \}
00213 
00214   \textcolor{keywordflow}{if}(type > 2)
00215     energy += P->TerminalAU;
00216 
00217   energy += P->MLintern[type];
00218 
00219   \textcolor{keywordflow}{return} energy;
00220 \}
00221 
00222 
00223 
00224 PRIVATE INLINE \hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL}
00225 exp\_E\_MLstem( \textcolor{keywordtype}{int} type,
00226               \textcolor{keywordtype}{int} si1,
00227               \textcolor{keywordtype}{int} sj1,
00228               \hyperlink{group__energy__parameters_structvrna__exp__param__s}{vrna\_exp\_param\_t} *P)\{
00229 
00230   \textcolor{keywordtype}{double} energy = 1.0;
00231   \textcolor{keywordflow}{if}(si1 >= 0 && sj1 >= 0)\{
00232     energy = P->expmismatchM[type][si1][sj1];
00233   \}
00234   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(si1 >= 0)\{
00235     energy = P->expdangle5[type][si1];
00236   \}
00237   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(sj1 >= 0)\{
00238     energy = P->expdangle3[type][sj1];
00239   \}
00240 
00241   \textcolor{keywordflow}{if}(type > 2)
00242     energy *= P->expTermAU;
00243 
00244   energy *= P->expMLintern[type];
00245   \textcolor{keywordflow}{return} (\hyperlink{group__data__structures_ga31125aeace516926bf7f251f759b6126}{FLT\_OR\_DBL})energy;
00246 \}
00247 
00252 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
